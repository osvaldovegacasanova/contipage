---
import Title3 from "../../../shared/Title3.astro";

export interface Contact {
  type: "phone" | "email";
  label: string;
  value: string;
  href: string;
}

export interface Props {
  title: string;
  description: string;
  icon: "office" | "warehouse" | "contact";
  contacts?: Contact[];
}

const { title, description, icon, contacts } = Astro.props;
---

<div
  class="group overflow-hidden rounded-lg h-full flex flex-col bg-white dark:bg-base-dark-800 shadow-lg dark:shadow-dark ring-1 ring-black/5 border border-box-border/60 pt-2"
>
  <div class="grid grid-cols-1 content-between h-full mx-6 mb-6">
    <div class="flex">
      <div class="m-6">
        <div
          class="flex h-[54px] w-[54px] items-center justify-center rounded-2xl bg-primary/10 text-primary"
        >
          {icon === "office" && (
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="1.6"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="h-8 w-8"
            >
              <path d="M4.5 21V5.25a1.25 1.25 0 0 1 1.25-1.25H9.5a1.25 1.25 0 0 1 1.25 1.25V21" />
              <path d="M13.25 21V3.75A1.75 1.75 0 0 1 15 2h4a1.75 1.75 0 0 1 1.75 1.75V21" />
              <path d="M3 21h18" />
              <path d="M7 9h1.5" />
              <path d="M15.5 6h1.5" />
              <path d="M15.5 9h1.5" />
              <path d="M15.5 12h1.5" />
            </svg>
          )}
          {icon === "warehouse" && (
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="1.6"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="h-8 w-8"
            >
              <path d="M2.5 9 12 3l9.5 6" />
              <path d="M4 10.5V21h16V10.5" />
              <path d="M8 21v-5.5h8V21" />
              <path d="M8 12h2" />
              <path d="M14 12h2" />
            </svg>
          )}
          {icon === "contact" && (
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="1.6"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="h-8 w-8"
            >
              <path d="M4 5h16a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V6a1 1 0 0 1 1-1Z" />
              <path d="M3 7.5 12 13l9-5.5" />
              <path d="M7 17h10" />
            </svg>
          )}
        </div>
      </div>
      <Title3 className="dark:opacity-70 self-center">
        {title}
      </Title3>
    </div>

    <div class="self-baseline">
      {description && (
        <div class="text-sm opacity-60">
          {description}
        </div>
      )}
      {contacts && contacts.length > 0 && (
        <div class="text-sm opacity-60 space-y-2">
          {contacts.map((contact) => (
            <div>
              <a
                href={contact.href}
                class="hover:text-primary transition-colors inline-flex items-center gap-2"
                data-contact-type={contact.type}
                data-contact-value={contact.value}
              >
                {contact.type === "phone" && (
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
                  </svg>
                )}
                {contact.type === "email" && (
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="2" y="4" width="20" height="16" rx="2"></rect>
                    <path d="m2 7 10 6 10-6"></path>
                  </svg>
                )}
                <span>{contact.label}</span>
              </a>
            </div>
          ))}
        </div>
      )}
    </div>
  </div>
</div>

<script>
  import { trackContactClick } from "../../../../utils/analytics";

  // Add click tracking to contact links
  document.addEventListener('DOMContentLoaded', () => {
    const contactLinks = document.querySelectorAll('[data-contact-type]');

    contactLinks.forEach((link) => {
      link.addEventListener('click', (e) => {
        const target = e.currentTarget as HTMLElement;
        const contactType = target.getAttribute('data-contact-type') as 'phone' | 'email';
        const contactValue = target.getAttribute('data-contact-value') || '';

        if (contactType && contactValue) {
          trackContactClick(contactType, contactValue);
        }
      });
    });
  });
</script>
